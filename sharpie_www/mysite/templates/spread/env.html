{% extends "base.html" %}

{% block content %}
{% load static %}
  <script>
    var left = 0;
    var right = 0;
    var up = 0;
    var down = 0;
    document.addEventListener('keydown', (event)=> {
        if(event.key == 'ArrowLeft'){
          left = 1;
          right = 0;
          up = 0;
          down = 0;
        } else if(event.key == 'ArrowRight') {
          left = 0;
          right = 1;
          up = 0;
          down = 0;
        } else if(event.key == 'ArrowDown') {
          left = 0;
          right = 0;
          up = 0;
          down = 1;
        } else if(event.key == 'ArrowUp') {
          left = 0;
          right = 0;
          up = 1;
          down = 0;
        } else if(event.key == ' ') {
          left = 0;
          right = 0;
          up = 0;
          down = 0;
        }
    });


    function myCallback() {
      fetch("http://localhost:8000/spread/step?left=" + left + "&right=" + right + "&up=" + up + "&down=" + down)
      .then(function(response) {
           document.getElementById("image").src = "{% static 'spread/step.png' %}?"+new Date().getTime();
           json = response.json()
           .then(function(j) {
              console.log(j);
              if(j.is_terminated == 0){
                myCallback();
               }
            });
        });
    };

    myCallback();
  </script>

  <section class="text-center">
    <div class="container">
      <br>
      <h1>Simple Spread example</h1>
    </div>
  </section>

  <br>
  <div class="container">
    <div class="row align-items-center">
      <div class="col">
          <img id="image" src="{% static 'spread/step.png' %}">
      </div>
    </div>
  </div>
{% endblock %}